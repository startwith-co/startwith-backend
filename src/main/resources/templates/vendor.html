<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>벤더 심사</title>
    <style>
        body { font-family: "Noto Sans KR", sans-serif; margin: 10px; }
        h2 { margin-bottom: 15px; font-size: 18px; }
        table {
            width: 100%; border-collapse: collapse; margin-bottom: 20px; table-layout: fixed;
        }
        th, td {
            border: 1px solid #ccc; padding: 6px; text-align: center; font-size: 12px; word-break: break-word;
        }
        th { background-color: #f5f5f5; font-weight: 600; }

        .btn-action {
            padding: 4px 8px; font-size: 11px; margin: 0 2px; border-radius: 3px; cursor: pointer;
        }
        .btn-approve {
            background-color: #28a745; color: white; border: none;
        }
        .btn-disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .pagination {
            text-align: center;
            margin-top: 10px;
        }

        .pagination a {
            margin: 0 2px;
            padding: 4px 8px;
            text-decoration: none;
            font-size: 12px;
            color: #007bff;
            border: 1px solid #ddd;
            border-radius: 3px;
        }

        .pagination a.disabled {
            color: #aaa;
            pointer-events: none;
            border-color: #eee;
        }
    </style>
</head>
<body>
<h2>벤더 심사</h2>

<!-- 에러 메시지 alert -->
<script th:if="${errorMessage != null}" th:inline="javascript">
    alert([[${errorMessage}]]);
</script>

<table>
    <thead>
    <tr>
        <th>가입 일시</th>
        <th>기업 이름</th>
        <th>담당자 이름</th>
        <th>전화번호</th>
        <th>이메일</th>
        <th>심사 상태</th>
        <th>관리</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="vendor : ${vendors}">
        <td th:text="${vendor.registerCompletedAt != null ? #temporals.format(vendor.registerCompletedAt, 'yyyy-MM-dd HH:mm:ss') : '-'}">-</td>
        <td th:text="${vendor.vendorName ?: '-'}">-</td>
        <td th:text="${vendor.managerName ?: '-'}">-</td>
        <td th:text="${vendor.phoneNumber ?: '-'}">-</td>
        <td th:text="${vendor.email ?: '-'}">-</td>
        <td th:text="${vendor.audit ? '승인 완료' : '심사 보류'}">-</td>
        <td>
            <!-- 승인 처리 버튼: audit이 false일 때만 활성화 -->
            <form th:action="@{/admin/vendor/approve}" method="post" style="display:inline;">
                <input type="hidden" name="email" th:value="${vendor.email}" />
                <input type="hidden" name="page" th:value="${currentPage}" />
                <button type="submit"
                        class="btn-action btn-approve"
                        th:classappend="${vendor.audit} ? 'btn-disabled'"
                        th:attr="disabled=${vendor.audit}">승인 처리</button>
            </form>

            <!-- 거절 처리 버튼: audit이 true일 때만 활성화 -->
            <form th:action="@{/admin/vendor/cancel}" method="post" style="display:inline;">
                <input type="hidden" name="email" th:value="${vendor.email}" />
                <input type="hidden" name="page" th:value="${currentPage}" />
                <button type="submit"
                        class="btn-action btn-approve"
                        th:classappend="${!vendor.audit} ? 'btn-disabled'"
                        th:attr="disabled=${!vendor.audit}">거절 처리</button>
            </form>
        </td>
    </tr>
    </tbody>
</table>

<div class="pagination">
    <a th:href="@{/admin/vendor(page=${currentPage - 1})}"
       th:classappend="${currentPage == 0} ? ' disabled' : ''">이전</a>

    <a th:href="@{/admin/vendor(page=${currentPage + 1})}"
       th:classappend="${!hasNext} ? ' disabled' : ''">다음</a>
</div>
</body>
</html>